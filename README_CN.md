# 克雷洛夫子空间矩阵求解算法简介
本仓库含有我本人撰写的关于克雷洛夫子空间各种常见算法（如兰乔斯、阿诺尔迪、克雷洛夫-舒尔、广义最小残量、最小残量以及共轭梯度法）的介绍和伪代码，这些算法均适用于大型矩阵的高效并行计算，它们按照用途可以分为两类：用来求解特征问题的和用来求解线性方程组问题的。

对于希望结合实际代码的读者，我强烈推荐我的另一个代码库`Althea`（目前正在进行开发，马上将要公开代码仓库）。在其`Althea.Backend.CSharp.Solver.Krylov.KrylovBased.cs`中，你可以找到绝大部分正文伪代码的实现；在其`Althea.Backend.CSharp.LinearAlgebra.MatrixSolvers.cs`中，你可以找到绝大部分第0章伪代码的实现。这些代码都含有TeX公式的注释，你可以使用TeX Comments等插件帮助排版显示。

## 前言

在我有限的学习和科研生活中，我曾使用有限元、梯度流、密度矩阵重整化群等方法计算过常/偏微分方程、泛函最优化、张量网络等问题，这些问题的应用领域涵盖物理、化学、生物等学科，这些方法使用到了兰乔斯算法、克雷洛夫-舒尔算法、广义最小残量法、共轭梯度法等具体数值算法用以求解或稀疏或特殊的大型矩阵，这些矩阵均无法以密集形式存储于内存当中。这些方法自然是有内在联系的——它们都是克雷洛夫子空间方法，然而我并没有找到讲义或书籍完整地讲述这些方法以及它们之间的联系，我感觉这样不利于初学者建立一个完善的框架，从而在编写代码时难以使用恰当的算法，或当算法出现问题时难以快速定位，或难以写出易读且高效的特定需求算法。因此，我逐渐萌生了撰写这样一本讲义的想法：不仅仅是为了我自己写代码时的参考，同样也是希望读到这本讲义的人能少走一些弯路。

本讲义主要由六部分组成：预备知识和引入、厄米矩阵特征问题、非厄米矩阵特征问题、非厄米矩阵线性系统问题和厄米矩阵线性系统问题。由于篇幅问题，其中“预备知识”单独成章，“引入”单独成部，而“线性系统问题”和为一部。

第0章主要介绍了QR算法以及用其实现的特征分解和舒尔分解，这一章的算法不涉及克雷洛夫子空间，并且没有展开各种证明过程，但是我仍旧认为需要加入这一章——克雷洛夫子空间各种方法都需要其中的一种或多种算法作为基础，并且它们的复杂度相对于克雷洛夫子空间方法是可以忽略的，因此可以使用任何读者习惯的语言实现而基本不会影响整体性能，这也避免了某些基础库如MKL的依赖：比如你希望用GPU加速计算，那么可以在GPU上实现克雷洛夫子空间方法的耗时部分（大型矩阵、向量运算），并直接用CPU实现一个简单的第0章对应算法而无需关心MKL是否支持使用的CPU芯片。

第一部分从最简单的克雷洛夫子空间方法——幂迭代——引入克雷洛夫子空间的概念，得到了最基础的适用于非厄米矩阵的阿诺尔迪算法，为接下来着重介绍的兰乔斯算法打好基础。

第二部分从厄米条件对阿诺尔迪算法的简化开始，得到了基础兰乔斯算法。接下来，这一部分主要在关注兰乔斯算法的收敛性证明——因为之后的收敛性证明大都与其非常相似，为了减轻读者负担，所以往往忽略了。这一部分还讨论了非常重要的技巧——重启。这能避免部分的累积数值误差并减少内存消耗，它在接下来的特征问题算法中也是非常重要的。

第三部分回到了基础的阿诺尔迪算法并介绍了它的重启方法。由于第0章已经介绍过，小型非厄米矩阵的特征分解往往需要经过舒尔分解的中间步骤，以加强数值稳定性，由此引入了收敛性更好的克雷洛夫-舒尔算法。

第四部分关注的是线性系统问题。由于之前的铺垫，我选择直接从最复杂也是与之前联系最紧密算法——广义最小残量法——开始，它是用于求解非厄米矩阵线性系统问题的算法。通过考虑越来越特殊的矩阵，我接着介绍了最小残量法、共轭梯度法以及它们的预处理算法。

## 目录
- [第0章 预备知识]()
	- [第1节 记号]()
	- [第2节 特征分解的定义]()
	- [第3节 瑞利商]()
	- [第4节 QR分解]()
	- [第5节 实对称三对角矩阵的特征分解]()
	- [第6节 海森伯格矩阵的舒尔分解]()
	- [第7节 海森伯格矩阵的特征分解]()

- [第一部分 引入]()
	- [第1章 从幂迭代开始]()
		- [第1节 什么是幂迭代]()
		- [第2节 幂迭代的收敛性]()
	- [第2章 克雷洛夫子空间]()
	- [第3章 阿诺尔迪算法]()
		- [第1节 阿诺尔迪算法与阿诺尔迪关系]()
		- [第2节 基本阿诺尔迪算法]()

- [第二部分 厄米矩阵特征问题]()
	- [第4章 基本兰乔斯算法]()
		- [第1节 为什么兰乔斯可以收敛]()
		- [第2节 兰乔斯的收敛判据]()
		- [第3节 兰乔斯的数值误差]()
	- [第5章 进阶兰乔斯数值方法]()
		- [第1节 利用收敛判据的兰乔斯算法]()
		- [第2节 部分重正交化]()
		- [第3节 分块兰乔斯 / 带状兰乔斯]()
		- [第4节 特征谱筛选]()
	- [第6章 兰乔斯的重启方法]()
		- [第1节 为什么要重启]()
		- [第2节 为什么能重启]()
		- [第3节 厚重启算法流程]()
		- [第4节 如何选择保留向量]()
		- [第5节 厚重启的启发式策略]()
	- [第7章 实现之前所有技巧的兰乔斯算法]()
		- [第1节 特征谱边缘的单个特征值]()
		- [第2节 特征谱中间的特征值]()

- [第三部分 非厄米矩阵特征问题]()
	- [第8章 阿诺尔迪算法]()
		- [第1节 回顾]()
		- [第2节 为什么要重启]()
		- [第3节 收敛判据]()
		- [第4节 显式重启]()
	- [第9章 克雷洛夫-舒尔算法]()
		- [第1节 克雷洛夫分解]()
		- [第2节 重启]()

- [第四部分 线性系统问题]()
	- [第10章 非厄米矩阵的线性系统问题]()
		- [第1节 引入]()
		- [第2节 广义最小残量方法]()
		- [第3节 重启]()
		- [第4节 与非厄米特征问题的联系]()
	- [第11章 厄米矩阵的线性系统问题]()
		- [第1节 最小残量法]()
		- [第2节 共轭梯度法]()
	- [第12章 收敛性与预处理]()
		- [第1节 共轭梯度法的收敛性]()
		- [第2节 预处理]()

- [第五部分 性能分析]()
	- [第13章 兰乔斯性能分析]()
		- [第1节 基本兰乔斯算法]()
		- [第2节 加入收敛判据的兰乔斯算法]()
		- [第3节 加入重正交化的兰乔斯算法]()
		- [第4节 带状兰乔斯算法]()
		- [第5节 分块兰乔斯算法]()
	- [第14章 阿诺尔迪算法]()
		- [第1节 基本阿诺尔迪算法]()
		- [第2节 显式重启阿诺尔迪算法]()
		- [第3节 克雷洛夫-舒尔算法]()

