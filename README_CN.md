# 克雷洛夫子空间矩阵求解算法简介
本仓库含有我本人撰写的关于克雷洛夫子空间各种常见算法（如兰乔斯、阿诺尔迪、克雷洛夫-舒尔、广义最小残量、最小残量以及共轭梯度法）的介绍和伪代码，这些算法均适用于大型矩阵的高效并行计算，它们按照用途可以分为两类：用来求解特征问题的和用来求解线性方程组问题的。

对于希望结合实际代码的读者，我强烈推荐我的另一个代码库`Althea`（目前正在进行开发，马上将要公开代码仓库）。在其`Althea.Backend.CSharp.Solver.Krylov.KrylovBased.cs`中，你可以找到绝大部分正文伪代码的实现；在其`Althea.Backend.CSharp.LinearAlgebra.MatrixSolvers.cs`中，你可以找到绝大部分第0章伪代码的实现。这些代码都含有TeX公式的注释，你可以使用TeX Comments等插件帮助排版显示。

> 本仓库的`README.md`到PDF的超链接均包含页码，但由于GitHub可能无法正确转跳到这些页码，我还在超链接文本中加入了页码提示。

# 前言

在我有限的学习和科研生活中，我曾使用有限元、梯度流、密度矩阵重整化群等方法计算过常/偏微分方程、泛函最优化、张量网络基态等问题，这些问题的应用领域涵盖物理、化学、生物等学科，这些方法使用到了兰乔斯算法、克雷洛夫-舒尔算法、广义最小残量法、共轭梯度法等具体数值算法用以求解或稀疏或特殊的大型矩阵，这些矩阵均无法以密集形式存储于内存当中。这些方法自然是有内在联系的——它们都是克雷洛夫子空间方法，然而我并没有找到讲义或书籍完整地讲述这些方法以及它们之间的联系，我感觉这样不利于初学者建立一个完善的框架，从而在编写代码时难以使用恰当的算法，或当算法出现问题时难以快速定位，或难以写出易读且高效的特定需求算法。因此，我逐渐萌生了撰写这样一本讲义的想法：不仅仅是为了我自己写代码时的参考，同样也是希望读到这本讲义的人能少走一些弯路。

本讲义主要由三部分组成：预备知识和引入、特征问题、线性系统。由于篇幅问题，其中“预备知识”单独成章，而“特征问题”分为了厄米矩阵和非厄米矩阵两部分。在阅读之前，我觉得你需要了解一般本科中教授的《高等线性代数》或《线性代数II》的内容，否则你可能在很多基础概念上例如线性空间都要卡住。

第0章主要介绍了QR算法以及用其实现的特征分解和舒尔分解，这一章的算法不涉及克雷洛夫子空间，并且没有展开各种证明过程，但是我仍旧认为需要加入这一章——克雷洛夫子空间各种方法都需要其中的一种或多种算法作为基础，并且它们的复杂度相对于克雷洛夫子空间方法是可以忽略的，因此可以使用任何你习惯的语言实现而基本不会影响整体性能，这也避免了某些基础库如MKL的依赖：比如你希望用GPU加速计算，那么可以在GPU上实现克雷洛夫子空间方法的耗时部分（大型矩阵、向量运算），并直接用CPU实现一个简单的第0章对应算法而无需关心MKL是否支持使用的CPU芯片。

第一部分从最简单的克雷洛夫子空间方法——幂迭代——引入克雷洛夫子空间的概念，得到了最基础的适用于非厄米矩阵的阿诺尔迪算法，为接下来着重介绍的兰乔斯算法打好基础。

第二部分从厄米条件对阿诺尔迪算法的简化开始，得到了基础兰乔斯算法。接下来，这一部分主要在关注兰乔斯算法的收敛性证明——因为之后的收敛性证明大都与其非常相似，为了减轻你负担，所以往往忽略了。这一部分还讨论了非常重要的技巧——重启。这能避免部分的累积数值误差并减少内存消耗，它在接下来的特征问题算法中也是非常重要的。

第三部分回到了基础的阿诺尔迪算法并介绍了它的重启方法。由于第0章已经介绍过，小型非厄米矩阵的特征分解往往需要经过舒尔分解的中间步骤，以加强数值稳定性，由此引入了收敛性更好的克雷洛夫-舒尔算法。

第四部分关注的是线性系统问题。由于之前的铺垫，我选择直接从最复杂也是与之前联系最紧密算法——广义最小残量法——开始，它是用于求解非厄米矩阵线性系统问题的算法。通过考虑越来越特殊的矩阵，我接着介绍了最小残量法、共轭梯度法以及它们的预处理算法。
整体上来讲，这个讲义不是非常偏向数学的讲义，我撰写的时候尽量避免涉及过于复杂的数学证明。但是我决定包含的数学证明都是我认为必须的：比如兰乔斯算法的收敛性证明，它是之后几章乃至下一部分费厄米特征问题的基础，这些内容中省略的证明往往是它的结论或证明过程十分类似。然而，这并不意味着这个讲义中的证明不注重数学严谨性，相反，我认为严谨的数学是不可或缺的，否则，我们将无法完全了解这些证明以及它们本身和它们的证明过程对之后问题的启发。

你在阅读过程中，会经常看到用不同底色标注出来的文字，它们是重要的例子以及对正文的补充。如果你的时间不是特别紧张，我建议你不要跳过它们。同时，你可能已经注意到了，我一般倾向于在这些例子中使用随机的矩阵，以避免任何有意或无意带来的偏差。同时，若不特别标注，这些矩阵都是使用双精度浮点数存储和运算的，但是由于篇幅限制，一般只保留6位有效数字，这可能会导致你用我的数据计算出来的结果和我有这个量级的偏差，但我认为这些误差不足以影响例子中的关键结论。

在讲义的最后，我还简要分析了一下正文的重要算法在典型CPU和GPU架构上的时间和空间复杂度，这一部分需要你事先了解基础的计算机组成原理和现代GPU的典型架构。如果你不计划对我介绍的算法进行大刀阔斧的改进，我认为一般复杂度变化不会明显，因此若你没有时间的话可以忽略这一部分，但是若你的时间和能力允许的话，我希望你能接着阅读这一部分——毕竟它也是对前面整个正文的总结和回忆。


# 目录
- 第零部分
	- [第0章 预备知识](zh/ch0/README.md)
- 第一部分 引入
	- [第1章 从幂迭代开始](zh/ch1/README.md)
	- [第2章 克雷洛夫子空间](zh/ch2/README.md)
	- [第3章 阿诺尔迪算法](zh/ch3/README.md)
- 第二部分 厄米矩阵特征问题
	- [第4章 基本兰乔斯算法](zh/ch4/README.md)
	- [第5章 进阶兰乔斯算法数值方法](zh/ch5/README.md)
	- [第6章 兰乔斯算法的重启方法](zh/ch6/README.md)
	- [第7章 实现之前所有技巧的兰乔斯算法](zh/ch7/README.md)
- 第三部分 非厄米矩阵特征问题
	- [第8章 阿诺尔迪算法](zh/ch8/README.md)
	- [第9章 克雷洛夫-舒尔算法](zh/ch9/README.md)
- 第四部分 线性系统问题
	- [第10章 非厄米矩阵的线性系统问题](zh/ch10/README.md)
	- [第11章 厄米矩阵的线性系统问题](zh/ch11/README.md)
	- [第12章 收敛性与预处理](zh/ch12/README.md)
- 第五部分 性能分析
	- [第13章 厄米矩阵算法](zh/ch13/README.md)
	- [第14章 非厄米矩阵算法](zh/ch14/README.md)